<nav x-data="{ isOpen: false, modals: {signup: 1, login: 2, recover: 3}, modal: null, }" class="relative bg-white shadow dark:bg-gray-800">
  <div class="container px-6 py-3 mx-auto md:flex">
    <div class="flex items-center justify-between w-full">
      <a href="#">
        <img class="w-auto h-6 sm:h-7" src="https://merakiui.com/images/full-logo.svg" alt="">
      </a>

      <!-- Mobile menu button -->
      <div class="flex lg:hidden">
        <button x-cloak @click="isOpen = !isOpen" type="button" class="text-gray-500 dark:text-gray-200 hover:text-gray-600 dark:hover:text-gray-400 focus:outline-none focus:text-gray-600 dark:focus:text-gray-400" aria-label="toggle menu">
          <svg x-show="!isOpen" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 8h16M4 16h16" />
          </svg>

          <svg x-show="isOpen" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <!-- Mobile Menu open: "block", Menu closed: "hidden" -->
      <div>
        <div x-cloak :class="[isOpen ? 'translate-x-0 opacity-100 ' : 'opacity-0 -translate-x-full']" class="absolute inset-x-0 z-20 w-full px-6 py-4 transition-all duration-300 ease-in-out bg-white dark:bg-gray-800 md:mt-0 md:p-0 md:top-0 md:relative md:opacity-100 md:translate-x-0 md:flex md:items-center md:justify-between">
          <div class="flex flex-col px-2 -mx-4 md:flex-row md:mx-10 md:py-0">
            <button @click="modal = modals.login" class="px-2.5 py-2 text-gray-700 transition-colors duration-300 transform rounded-lg dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 md:mx-2">Login</button>
            <button @click="modal = modals.signup" class="px-2.5 py-2 text-gray-700 transition-colors duration-300 transform rounded-lg dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 md:mx-2">SignUp</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="fixed inset-0 bg-black bg-opacity-25 grid place-items-center z-20" x-show="modal !== null" x-cloak="true" x-transition="">
    <div class="px-2 w-full max-w-lg">
      <div class="max-h-screen overflow-y-auto bg-white rounded shadow-2xl" @click.outside="modal = null" @keydown.escape.window="modal = null">
        <div class="p-4 lg:px-6 flex items-center justify-between">
          <i class="fi-icon-lock text-gray-700 lg:text-lg"></i>
          <div class="mx-2 grow lg:text-xl font-bold text-gray-900" x-text="modal === modals.signup ? 'Signup' : 'Login'"></div>
          <button class="lg:text-lg fi-icon-close hover:text-red-600" @click="modal = null"></button>
        </div>
        <div x-show="modal === modals.signup">
          <%= form_with scope: :user, url: user_registration_path, class: 'p-4 lg:px-6 border-t' do |f| %>
            <div>
              <%= f.label :email, "Email", class: 'text-gray-900 text-lg font-medium' %>
              <%= f.text_field :email, type: :email, placeholder: 'Email address', class: 'w-full form-input rounded-md mt-3', id: '#form_email_address' %>
            </div>
            <div class="mt-4">
              <%= f.label :password, "Password", class: 'text-gray-900 text-lg font-medium' %>
              <%= f.password_field :password, type: :password, placeholder: 'Password', class: 'w-full form-input rounded-md mt-3' %>
            </div>
            <div class="mt-4">
              <%= f.label :password_confirmation, "Confirm Password", class: 'text-gray-900 text-lg font-medium' %>
              <%= f.password_field :password_confirmation, placeholder: 'Confirm Password', class: 'w-full form-input rounded-md mt-3' %>
            </div>
            <%= f.button type: :submit, class: 'mt-4 btn btn-base w-full bg-forest-700 text-white justify-center', data: { disable_with: 'Please wait...' } do %>
              <span>Sign Up</span>
              <i class="ml-2 fi-icon-arrow-right"></i>
            <% end %>
            <div class="border-t p-4 lg:p-6">
              <div class="mt-2 text-sm">
                <span>Already have an account?</span>
                <button class="font-medium text-gray-700" @click.prevent="modal = modals.login">Login</button>
              </div>
            </div>
          <% end %>
        </div>
        <div x-show="modal === modals.login">
          <%= form_with scope: :user, url: new_user_session_path, class: 'p-4 lg:px-6 border-t' do |f| %>
            <div>
              <%= f.label :email, "Email", class: 'text-gray-900 text-lg font-medium' %>
              <%= f.text_field :email, type: :email, placeholder: 'Email address', class: 'w-full form-input rounded-md mt-3', id: '#form_email_address' %>
            </div>
            <div class="mt-4">
              <%= f.label :password, "Password", class: 'text-gray-900 text-lg font-medium' %>
              <%= f.text_field :password, type: :password, placeholder: 'Password', class: 'w-full form-input rounded-md mt-3' %>
            </div>
            <%= f.button type: :submit, class: 'mt-4 btn btn-base w-full bg-forest-700 text-white justify-center', data: { disable_with: 'Please wait...' } do %>
              <span>Login</span>
              <i class="ml-2 fi-icon-arrow-right"></i>
            <% end %>
            <div class="border-t p-4 lg:p-6">
              <div class="mt-2 text-sm">
                <span>Don’t have an account?</span>
                <button class="font-medium text-gray-700" @click.prevent="modal = modals.signup">Sign Up</button>
              </div>
              <div class="mt-2 text-sm">
                <span>Forget Password?</span>
                <button class="font-medium text-gray-700" @click.prevent="modal = modals.recover">Recover</button>
              </div>
            </div>
          <% end %>
        </div>
        <div x-show="modal === modals.recover">
          <%= form_with scope: :user, url: "#", class: 'p-4 lg:px-6 border-t' do |f| %>
            <div>
              <%= f.label :email, "Email", class: 'text-gray-900 text-lg font-medium' %>
              <%= f.text_field :email, type: :email, placeholder: 'Email Address', class: 'mt-3 w-full form-input rounded-md' %>
            </div>
            <%= f.button "Recover", type: :submit, class: 'mt-4 btn btn-base w-full bg-forest-700 text-white disabled:opacity-50 justify-center', data: { disable_with: 'Please wait...' } %>
            <div class="border-t p-4 lg:p-6">
              <div class="mt-2 text-sm">
                <span>Don’t have an account?</span>
                <button class="font-medium text-gray-700" @click.prevent="modal = modals.signup">Sign Up</button>
              </div>
              <div class="mt-2 text-sm">
                <span>Already an existing user?</span>
                <button class="font-medium text-gray-700" @click.prevent="modal = modals.login">Login</button>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</nav>